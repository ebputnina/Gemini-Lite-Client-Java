[ {
    "type": "client",
    "name": "Invalid localhost port number in the URL.",
    "url": "gemini-lite://localhost:900B/",
    "transactions": [],
    "exitcode": 1,
    "stdout": "",
    "justification": "If the user accidentally enters an invalid port number (in this case including a letter), that's a local parsing error. It's mentioned in requirement 2: 'if some local error situation arises... the client must print an error report to System.err, must not output anything to System.out, and must terminate with exit code 1.'"
  },
  {
    "type": "client",
    "name": "Client rejects 20 reply without metadata.",
    "url": "gemini-lite://localhost/badheader",
    "transactions": [
      {
        "url": "gemini-lite://localhost/badheader",
        "reply": "20\r\n"
      }
    ],
    "exitcode": 1,
    "stdout": "",
    "justification": "The Gemini protocol, below the name Success, states that a 20 Success status must include a MIME type as metadata: 'success  = \"2\" DIGIT SP mimetype CRLF body'. "
  },
  {
    "type": "client",
    "name": "Client handles input reply and encodes input as query.",
    "url": "gemini-lite://localhost:1958/input",
    "input": "secret value",
    "transactions": [
      {
        "url": "gemini-lite://localhost:1958/input",
        "reply": "11 EnterSecret\r\n"
      },
      {
        "url": "gemini-lite://localhost:1958/input?secret%20value",
        "reply": "20 text/plain\r\nSecret response"
      }
    ],
    "exitcode": 0,
    "stdout": "Secret response\n",
    "justification": "In Gemini Network Protocol Specification (status codes), it says that 'If a client receives a 1x response to a URI that already contains a query string, the client MUST replace the query string with the user input'. "
  },
  {
    "type": "client",
    "name": "Catch 'absolute nonesene' in the server response: non-numeric status.",
    "url": "gemini-lite://localhost/absolutenonesense",
    "transactions": [
      {
        "url": "gemini-lite://localhost/absolutenonesense",
        "reply": "XX Invalid Status\r\n"
      }
    ],
    "exitcode": 1,
    "stdout": "",
    "justification": "As mentioned in the project specification Requirement 2 in 'Course Project: Gemini Lite', 'the client must print an error report to System.err, must not output anything to System.out, and must terminate with exit code 1.'"
  },
  {
    "type": "server",
    "name": "Reject path traversal attempts outside docroot",
    "documents": {
      "index.txt": "Hello ello"
    },
    "request": "gemini-lite://localhost/../../../../../../etc/passwd\r\n",
    "reply_regex": "^5[0-9]( .+)$",
    "body": "",
    "justification": "As per Requirement 3 in 'Course Project: Gemini Lite', 'ensure your program cannot allow clients to request files from outside the specified document root directory'."
  },
  {
    "type": "server",
    "name": "Server rejects requests exceeding 1024 byte URI limit.",
    "documents": {
      "index.txt": "Hello"
    },
    "request": "gemini-lite://localhost/aaaaahelloaaaaaaaiaaaaaaaamaaaaaveryaaaaaaaveryaaaaaaaaacoolaaaaaaaayesaaaaaaaaaaaaathatsaaaaaaaaaaaaaaarightaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\r\n",
    "reply_regex": "^59 .*",
    "body": "",
    "justification": "The Gemini specification states: 'When making a request, the URI MUST NOT exceed 1024 bytes, and a server MUST reject requests where the URI exceeds this limit.' The server should return status 59 (bad request) when receiving a URI longer than 1024 bytes."
  },
  {
    "type": "server",
    "name": "Serve binary file with unknown extension (.bin)",
    "documents": {
      "file.bin": "BINARYDATA"
    },
    "request": "gemini-lite://localhost/file.bin\r\n",
    "reply_regex": "^20 application/octet-stream$",
    "body": "BINARYDATA",
    "justification": "The specification in Requirement 3 in 'Course Project: Gemini Lite' mentions that if the URI path ends with .gmi → text/gemini; if .txt → text/plain; otherwise → application/octet-stream in Requirement 3. This ensures files with unknown extensions are served as application/octet-stream (a good fallback)."
  },
  {
    "type": "server",
    "name": "Serves text/gemini MIME type for files with .gmi",
    "documents": {
      "index.gmi": "## ₍^. .^₎⟆ "
    },
    "request": "gemini-lite://localhost/index.gmi\r\n",
    "reply_regex": "^20 text/gemini$",
    "body": "## ₍^. .^₎⟆ ",
    "justification": "Requirement 3 'Course Project: Gemini Lite' mandates that .gmi files must be served as text/gemini."
  },
  {
    "type": "proxy",
    "name": "Proxy transparently follows redirects to client.",
    "request": "gemini-lite://localhost:1958/redirectme\r\n",
    "server_transactions": [
      {
        "url": "gemini-lite://localhost:1958/redirectme",
        "reply": "30 /final.txt\r\n"
      },
      {
        "url": "gemini-lite://localhost:1958/final.txt",
        "reply": "20 text/plain\r\nFinal content after redirect"
      }
    ],
    "reply_regex": "^20 text/plain$",
    "body": "Final content after redirect",
    "justification": "Requirement 4 states: 'Your proxy will have to handle redirections and slow down replies just like Client does, making them transparent to its own clients.'"
  },
  {
    "type": "proxy",
    "name": "Proxy returns 43 when there's an error (proxy error).",
    "request": "gemini-lite://localhost:1958/bad-redirect\r\n",
    "server_transactions": [
      {
        "url": "gemini-lite://localhost:1958/bad-redirect",
        "reply": "30 ://invalid url with spaces\r\n"
      }
    ],
    "reply_regex": "^43 .*",
    "body": "",
    "justification": "Adheres to Requirement 4 in 'Course Project: Gemini Lite': Certain error situations will result in a special reply code 43, “proxy error”. When the origin server returns a redirect with an invalid URI that cannot be resolved, the proxy should catch this error and return status 43 to its client."
  }
]